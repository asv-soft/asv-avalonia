<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:io="clr-namespace:Asv.Avalonia.IO"
             xmlns:avalonia="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
             xmlns:avalonia1="clr-namespace:Asv.Avalonia;assembly=Asv.Avalonia"
             mc:Ignorable="d" d:DesignWidth="1024" d:DesignHeight="450"
             x:Class="Asv.Avalonia.IO.SettingsConnectionView"
             x:DataType="io:SettingsConnectionViewModel">
    <Design.DataContext>
        <io:SettingsConnectionViewModel/>
    </Design.DataContext>
    <Panel>
        
    <Panel IsVisible="{Binding !View.Count}">
        <avalonia:MaterialIcon Width="50" Height="50" Margin="0,0,100,0" HorizontalAlignment="Right" VerticalAlignment="Top" Classes="warning blink-once" Kind="ArrowUpRightBold"/>
        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="8">
            <TextBlock FontSize="30" HorizontalAlignment="Left" VerticalAlignment="Bottom" Text="No connections"/>
            <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Text="Add a new one by clicking the button."/>    
        </StackPanel>
        
    </Panel>
    <Grid IsVisible="{Binding !!View.Count}" ColumnDefinitions="*,5,*">
        <ListBox Background="Transparent" ItemsSource="{Binding View}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}">
            <ListBox.Styles>
                <Style Selector="ListBoxItem">
                    <Setter Property="Background" Value="{DynamicResource SystemChromeMediumLowColor}" />
                    <Setter Property="Margin" Value="0,0,0,4" />
                    <Style Selector="^ Grid.disconnected">
                        <Style Selector="^ avalonia|MaterialIcon#PortIcon">
                            <Setter Property="Foreground" Value="{StaticResource AsvForegroundUnknownBrush}" />    
                        </Style>
                        <Style Selector="^ Ellipse">
                            <Setter Property="Stroke" Value="{StaticResource AsvForegroundUnknownBrush}" />    
                            <Setter Property="Fill" Value="{StaticResource AsvBackgroundUnknownBrush}" />
                        </Style>
                    </Style>
                    <Style Selector="^ Grid.progress">
                        <Style Selector="^ avalonia|MaterialIcon#PortIcon">
                            <Setter Property="Foreground" Value="{StaticResource AsvForegroundWarningBrush}" />    
                        </Style>
                        <Style Selector="^ Ellipse">
                            <Setter Property="Stroke" Value="{StaticResource AsvForegroundWarningBrush}" />    
                            <Setter Property="Fill" Value="{StaticResource AsvBackgroundWarningBrush}" />
                        </Style>
                    </Style>
                    <Style Selector="^ Grid.connected">
                        <Style Selector="^ avalonia|MaterialIcon#PortIcon">
                            <Setter Property="Foreground" Value="{StaticResource AsvForegroundSuccessBrush}" />    
                        </Style>
                        <Style Selector="^ Ellipse">
                            <Setter Property="Stroke" Value="{StaticResource AsvForegroundSuccessBrush}" />    
                            <Setter Property="Fill" Value="{StaticResource AsvBackgroundSuccessBrush}" />
                        </Style>
                    </Style>
                    <Style Selector="^ Grid.error">
                        <Style Selector="^ avalonia|MaterialIcon#PortIcon">
                            <Setter Property="Foreground" Value="{StaticResource AsvForegroundErrorBrush}" />    
                        </Style>
                        <Style Selector="^ Ellipse">
                            <Setter Property="Stroke" Value="{StaticResource AsvForegroundErrorBrush}" />    
                            <Setter Property="Fill" Value="{StaticResource AsvBackgroundErrorBrush}" />
                        </Style>
                    </Style>
                </Style>
            </ListBox.Styles>
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid ColumnDefinitions="50,8,*,90" 
                          RowDefinitions="*,*"
                          ToolTip.Tip="{Binding StatusMessage}"
                          Classes.error="{Binding Status, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Error}"
                          Classes.progress="{Binding Status, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=InProgress}"
                          Classes.connected="{Binding Status, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Connected}"
                          Classes.disconnected="{Binding Status, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Disconnected}"
                          >
                       <Ellipse
                           Classes.blink="{Binding Status, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=InProgress}"
                           Grid.RowSpan="2"  Width="50" Height="50" StrokeThickness="1" Stroke="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"></Ellipse>
                        <avalonia:MaterialIcon x:Name="PortIcon"
                                               Classes.blink="{Binding Status, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=InProgress}"
                                               Margin="8" 
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Grid.Row="0" Grid.RowSpan="2" Grid.Column="0"
                                               Width="30"
                                               Height="30" 
                                               Kind="{Binding Icon}" />
                       
                        <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="2">
                            <TextBlock VerticalAlignment="Center" 
                                       Classes="h1"
                                       Margin="0,0,4,4" Text="{Binding Name.Value}" />
                            
                        </StackPanel>
                        <ItemsControl Grid.Row="1" Grid.Column="2" ItemsSource="{Binding TagsView}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <avalonia1:Tag 
                                        Margin="0,0,4,4"
                                        Key="{Binding Key}" 
                                        Value="{Binding Value}" 
                                        Icon="{Binding Icon}"
                                        Classes.error="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Error}"
                                        Classes.warning="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Warning}"
                                        Classes.success="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Success}"
                                        Classes.unknown="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Unknown}"
                                        Classes.info="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Info}"
                                        Classes.info2="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Info2}"
                                        Classes.info3="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Info3}"
                                        Classes.info4="{Binding  TagType, Converter={x:Static avalonia1:EnumToBooleanConverter.Instance}, ConverterParameter=Info4}"
                                        />
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <ToggleSwitch Grid.Row="0" Grid.RowSpan="2" Grid.Column="3" VerticalAlignment="Center" IsChecked="{Binding IsEnabled.Value}">
                            <ToggleSwitch.OffContent>
                                <TextBlock Text="{x:Static io:RS.PortView_Switch_Off}"/>
                            </ToggleSwitch.OffContent>
                            <ToggleSwitch.OnContent>
                                <TextBlock Text="{x:Static io:RS.PortView_Switch_On}"/>
                            </ToggleSwitch.OnContent>
                        </ToggleSwitch>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        
        <Panel Margin="8" VerticalAlignment="Stretch" Grid.Row="0" Grid.Column="2">
            <Panel IsVisible="{Binding SelectedItem, Converter={x:Static ObjectConverters.IsNotNull}}">
                <DockPanel DataContext="{Binding SelectedItem}">
                    <DockPanel DockPanel.Dock="Top" >
                        <avalonia:MaterialIcon DockPanel.Dock="Left" Margin="4" 
                                               HorizontalAlignment="Left" 
                                               Width="30"
                                               Height="30" 
                                               Kind="{Binding Icon}" />
                        <Button DockPanel.Dock="Right" Background="{DynamicResource AsvBackgroundErrorBrush}" Command="{Binding RemovePortCommand}">
                            <avalonia:MaterialIcon  Foreground="{DynamicResource AsvForegroundErrorBrush}" Kind="Trash"/>
                        </Button>
                        <TextBlock FontSize="30" VerticalAlignment="Center" 
                                   Margin="0,0,4,0" Text="{Binding Name.Value}" />
                    </DockPanel>
                    <ContentControl Margin="0,8,0,0" Content="{Binding}"/>
                </DockPanel>
                <StackPanel IsVisible="{Binding SelectedItem, Converter={x:Static ObjectConverters.IsNull}}"
                            HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Horizontal" Spacing="8">
                    <avalonia:MaterialIcon Width="25" Height="25" Kind="ArrowLeft"
                                           Foreground="{DynamicResource ButtonForegroundDisabled}" />
                    <TextBlock Foreground="{DynamicResource ButtonForegroundDisabled}" VerticalAlignment="Center"
                               FontSize="15" TextWrapping="WrapWithOverflow" MaxWidth="400" Text="Select port" />
                </StackPanel>

            </Panel>
        </Panel>
    </Grid>
    </Panel>
</UserControl>
